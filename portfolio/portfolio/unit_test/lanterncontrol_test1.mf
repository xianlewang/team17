;18649 Fall 2013
;Group 17
;Qiang Zhang(qiangz)/Shen Yu(sheny)/Jiang He(jiangh)/Xianle Wang(xianlew)
;lanterncontrol_test1.mf

#INCLUDE lantern_define.mf ;include CAN_ID and Period Definations
;initialize
0s I MESSAGE_PERIOD N ATFLOOR_1F_FRONT_CAN_ID AtFloor 1 FRONT = true
0s I MESSAGE_PERIOD N ATFLOOR_1F_BACK_CAN_ID  AtFloor 1 BACK  = false
0s I MESSAGE_PERIOD N ATFLOOR_2F_FRONT_CAN_ID AtFloor 2 FRONT = false
0s I MESSAGE_PERIOD N ATFLOOR_2F_BACK_CAN_ID  AtFloor 2 BACK  = false
0s I MESSAGE_PERIOD N ATFLOOR_3F_FRONT_CAN_ID AtFloor 3 FRONT = false
0s I MESSAGE_PERIOD N ATFLOOR_3F_BACK_CAN_ID  AtFloor 3 BACK  = false
0s I MESSAGE_PERIOD N ATFLOOR_4F_FRONT_CAN_ID AtFloor 4 FRONT = false
0s I MESSAGE_PERIOD N ATFLOOR_4F_BACK_CAN_ID  AtFloor 4 BACK  = false
0s I MESSAGE_PERIOD N ATFLOOR_5F_FRONT_CAN_ID AtFloor 5 FRONT = false
0s I MESSAGE_PERIOD N ATFLOOR_5F_BACK_CAN_ID  AtFloor 5 BACK  = false
0s I MESSAGE_PERIOD N ATFLOOR_6F_FRONT_CAN_ID AtFloor 6 FRONT = false
0s I MESSAGE_PERIOD N ATFLOOR_6F_BACK_CAN_ID  AtFloor 6 BACK  = false
0s I MESSAGE_PERIOD N ATFLOOR_7F_FRONT_CAN_ID AtFloor 7 FRONT = false
0s I MESSAGE_PERIOD N ATFLOOR_7F_BACK_CAN_ID  AtFloor 7 BACK  = false
0s I MESSAGE_PERIOD N ATFLOOR_8F_FRONT_CAN_ID AtFloor 8 FRONT = false
0s I MESSAGE_PERIOD N ATFLOOR_8F_BACK_CAN_ID  AtFloor 8 BACK  = false
0s I MESSAGE_PERIOD N DOOR_CLOSED_FRONT_LEFT_CAN_ID  DoorClosed FRONT LEFT  = true
0s I MESSAGE_PERIOD N DOOR_CLOSED_FRONT_RIGHT_CAN_ID DoorClosed FRONT RIGHT = true
0s I MESSAGE_PERIOD N DOOR_CLOSED_BACK_LEFT_CAN_ID   DoorClosed BACK  LEFT  = true
0s I MESSAGE_PERIOD N DOOR_CLOSED_BACK_RIGHT_CAN_ID  DoorClosed BACK  RIGHT = true
0s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 1 FRONT STOP

; check the lantern is off initially 
1.2s A F CarLantern UP : lighted == false

; set condition to T 7.1
2.0s I MESSAGE_PERIOD N DOOR_CLOSED_FRONT_LEFT_CAN_ID DoorClosed FRONT LEFT = false
2.0s I MESSAGE_PERIOD N DOOR_CLOSED_FRONT_RIGHT_CAN_ID DoorClosed FRONT RIGHT = false

; T 7.1
2.6s A F CarLantern UP : lighted == false
2.6s A S LanternControl[UP] : STATE == No_On

; set condition to T 7.3
3.4s I MESSAGE_PERIOD N DOOR_CLOSED_FRONT_LEFT_CAN_ID DoorClosed FRONT LEFT = true
3.4s I MESSAGE_PERIOD N DOOR_CLOSED_FRONT_RIGHT_CAN_ID DoorClosed FRONT RIGHT = true
3.4s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 3 FRONT UP

; T 7.3
4.4s A F CarLantern UP : lighted == false
4.4s A S LanternControl[UP] : STATE == Lantern_Off

; set condition to T 7.2
4.8s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 4 FRONT UP
5.0s I MESSAGE_PERIOD N ATFLOOR_1F_FRONT_CAN_ID AtFloor 1 FRONT = false
5.0s I MESSAGE_PERIOD N ATFLOOR_3F_FRONT_CAN_ID AtFloor 3 FRONT = true
5.0s I MESSAGE_PERIOD N DOOR_CLOSED_FRONT_LEFT_CAN_ID DoorClosed FRONT LEFT = false
5.0s I MESSAGE_PERIOD N DOOR_CLOSED_FRONT_RIGHT_CAN_ID DoorClosed FRONT RIGHT = false

; T 7.2
5.8s A F CarLantern UP : lighted == true
5.8s A S LanternControl[UP] : STATE == Lantern_On

; set condition to T 7.4
7.0s I MESSAGE_PERIOD N DOOR_CLOSED_FRONT_LEFT_CAN_ID DoorClosed FRONT LEFT = true 
7.0s I MESSAGE_PERIOD N DOOR_CLOSED_FRONT_RIGHT_CAN_ID DoorClosed FRONT RIGHT = true

; T 7.4
8.4s A F CarLantern UP : lighted == false
8.4s A S LanternControl[UP] : STATE == Lantern_Off



