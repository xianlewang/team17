;18649 Fall 2013
;Group 17 
; Qiang Zhang(qiangz)/Shen Yu(sheny)/Jiang He(jiangh)/Xianle Wang(xianlew)
;drivecontrol_test1.mf

#INCLUDE drive_defines.mf ;include CAN ID and Period Definations
;initialize
0s I MESSAGE_PERIOD N AT_FLOOR_[2][BACK]_CAN_ID AtFloor 2 BACK = false
0s I MESSAGE_PERIOD N AT_FLOOR_[3][FRONT]_CAN_ID AtFloor 3 FRONT = true
0s I MESSAGE_PERIOD N AT_FLOOR_[4][FRONT]_CAN_ID AtFloor 4 FRONT = false

0s I MESSAGE_PERIOD N LEVEL_SENSOR_[UP]_CAN_ID Leveling UP = true
0s I MESSAGE_PERIOD N LEVEL_SENSOR_[DOWN]_CAN_ID Leveling DOWN = true

0s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 3 FRONT STOP

0s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = false
0s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID DoorClosed FRONT RIGHT = true
0s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = true
0s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[BACK][RIGHT]_CAN_ID DoorClosed BACK RIGHT = true

0s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][LEFT]_CAN_ID DoorMotor FRONT LEFT = OPEN
0s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][RIGHT]_CAN_ID DoorMotor FRONT RIGHT = STOP
0s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[BACK][LEFT]_CAN_ID DoorMotor BACK LEFT = STOP
0s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[BACK][RIGHT]_CAN_ID DoorMotor BACK RIGHT = STOP

0s I MESSAGE_PERIOD N CAR_LEVEL_POSITION_CAN_ID CarLevelPosition = 10000

0s I MESSAGE_PERIOD F DriveSpeed = STOP 0.0


; check the Drive is STOP and check STATE is STOP
0.11s A F Drive : speed == STOP
0.11s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == STOP
0.11s A S DriveControl : STATE == STOP

;set conditins for T6.1
0.35s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = false
0.35s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][LEFT]_CAN_ID DoorMotor FRONT LEFT = STOP
0.35s I MESSAGE_PERIOD N LEVEL_SENSOR_[UP]_CAN_ID Leveling UP = false

0.35s I MESSAGE_PERIOD F DriveSpeed = UP 0.05

;check Drive is LEVEL UP, mDrive is SLOW UP and STATE is LEVEL UP
1.1s A F Drive : speed == LEVEL
1.1s A F Drive : direction == UP
1.1s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == LEVEL
1.1s A N DRIVE_COMMAND_CAN_ID DriveCommand : getDirection == UP
1.1s A S DriveControl : STATE == LEVEL_UP

;set conditins for T6.2
1.5s I MESSAGE_PERIOD N LEVEL_SENSOR_[UP]_CAN_ID Leveling UP = true
1.5s I MESSAGE_PERIOD N LEVEL_SENSOR_[DOWN]_CAN_ID Leveling DOWN = true

1.5s I MESSAGE_PERIOD F DriveSpeed = STOP 0.0

;check Drive is STOP STOP, mDrive is STOP STOP and STATE is STOP
2s A F Drive : speed == STOP
2s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == STOP
2s A S DriveControl : STATE == STOP

;set conditins for T6.3
2.5s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][LEFT]_CAN_ID DoorMotor FRONT LEFT = STOP
2.5s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][RIGHT]_CAN_ID DoorMotor FRONT RIGHT = STOP
2.5s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[BACK][LEFT]_CAN_ID DoorMotor BACK LEFT = STOP
2.5s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[BACK][RIGHT]_CAN_ID DoorMotor BACK RIGHT = STOP

2.5s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = true
2.5s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID DoorClosed FRONT RIGHT = true
2.5s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = true
2.5s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[BACK][RIGHT]_CAN_ID DoorClosed BACK RIGHT = true

2.5s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 4 FRONT STOP

2.5s I MESSAGE_PERIOD N AT_FLOOR_[3][FRONT]_CAN_ID AtFloor 3 FRONT = true

;check Drive is STOP STOP, mDrive is STOP STOP and STATE is STOP
2.511s A F Drive : speed == STOP
2.511s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == STOP
2.511s A S DriveControl : STATE == WAIT

;set conditins for T6.7
;check Drive is SLOW UP, mDrive is SLOW UP and STATE is SLOW_UP
2.8s A F Drive : speed == SLOW
2.8s A F Drive : direction == UP
2.8s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == SLOW
2.8s A N DRIVE_COMMAND_CAN_ID DriveCommand : getDirection == UP
2.8s A S DriveControl : STATE == SLOW_UP

;set conditins for T6.11
3.1s I MESSAGE_PERIOD F DriveSpeed = UP 0.35

;check Drive is FAST UP, mDrive is FAST UP and STATE is FAST_UP
3.3s A F Drive : speed == FAST
3.3s A F Drive : direction == UP
3.3s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == FAST
3.3s A N DRIVE_COMMAND_CAN_ID DriveCommand : getDirection == UP
3.3s A S DriveControl : STATE == FAST_UP

;set conditins for T6.12
3.5s I MESSAGE_PERIOD N CAR_LEVEL_POSITION_CAN_ID CarLevelPosition = 14200
3.5s I MESSAGE_PERIOD F DriveSpeed = UP 0.15

;check Drive is SLOW UP, mDrive is SLOW UP and STATE is SLOW_UP
3.75s A F Drive : speed == SLOW
3.75s A F Drive : direction == UP
3.75s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == SLOW
3.75s A N DRIVE_COMMAND_CAN_ID DriveCommand : getDirection == UP
3.75s A S DriveControl : STATE == SLOW_UP

;set conditins for T6.9
4s I MESSAGE_PERIOD N AT_FLOOR_[3][FRONT]_CAN_ID AtFloor 3 FRONT = false
4s I MESSAGE_PERIOD N AT_FLOOR_[4][FRONT]_CAN_ID AtFloor 4 FRONT = true
4s I MESSAGE_PERIOD N LEVEL_SENSOR_[UP]_CAN_ID Leveling UP = false
4s I MESSAGE_PERIOD N LEVEL_SENSOR_[DOWN]_CAN_ID Leveling DOWN = false

;check Drive is STOP and STATE is STOP
5s A F Drive : speed == STOP
5s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == STOP
5s A S DriveControl : STATE == STOP

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;down 

;set conditins for T6.5
10s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = false
10s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][LEFT]_CAN_ID DoorMotor FRONT LEFT = STOP
10s I MESSAGE_PERIOD N LEVEL_SENSOR_[UP]_CAN_ID Leveling UP = true
10s I MESSAGE_PERIOD N LEVEL_SENSOR_[DOWN]_CAN_ID Leveling DOWN = false
10s I MESSAGE_PERIOD F DriveSpeed = DOWN 0.05

;check Drive is LEVEL DOWN, mDrive is SLOW DOWN and STATE is LEVEL DOWN
11s A F Drive : speed == LEVEL
11s A F Drive : direction == DOWN
11s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == LEVEL
11s A N DRIVE_COMMAND_CAN_ID DriveCommand : getDirection == DOWN
11s A S DriveControl : STATE == LEVEL_DOWN

;set conditins for T6.6
12s I MESSAGE_PERIOD N LEVEL_SENSOR_[UP]_CAN_ID Leveling UP = true
12s I MESSAGE_PERIOD N LEVEL_SENSOR_[DOWN]_CAN_ID Leveling DOWN = true
12s I MESSAGE_PERIOD F DriveSpeed = DOWN 0.0

;check Drive is STOP STOP, mDrive is STOP STOP and STATE is STOP
13s A F Drive : speed == STOP
13s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == STOP
13s A S DriveControl : STATE == STOP

;set conditins for T6.3
14s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][LEFT]_CAN_ID DoorMotor FRONT LEFT = STOP
14s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][RIGHT]_CAN_ID DoorMotor FRONT RIGHT = STOP
14s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[BACK][LEFT]_CAN_ID DoorMotor BACK LEFT = STOP
14s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[BACK][RIGHT]_CAN_ID DoorMotor BACK RIGHT = STOP

14s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = true
14s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID DoorClosed FRONT RIGHT = true
14s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = true
14s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[BACK][RIGHT]_CAN_ID DoorClosed BACK RIGHT = true

14s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 3 FRONT STOP

14s I MESSAGE_PERIOD N AT_FLOOR_[4][FRONT]_CAN_ID AtFloor 4 FRONT = true

;check Drive is STOP STOP, mDrive is STOP STOP and STATE is WAIT
14.011s A F Drive : speed == STOP
14.011s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == STOP
14.011s A S DriveControl : STATE == WAIT

;set conditins for T6.8
;check Drive is SLOW DOWN, mDrive is SLOW DOWN and STATE is SLOW_DOWN
14.2s A F Drive : speed == SLOW
14.2s A F Drive : direction == DOWN
14.2s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == SLOW
14.2s A N DRIVE_COMMAND_CAN_ID DriveCommand : getDirection == DOWN
14.2s A S DriveControl : STATE == SLOW_DOWN

;set conditins for T6.13
;14.5s I MESSAGE_PERIOD F DriveSpeed = DOWN 0.15
14.5s I MESSAGE_PERIOD F DriveSpeed = DOWN 0.30
14.5s I MESSAGE_PERIOD N CAR_LEVEL_POSITION_CAN_ID CarLevelPosition = 15000

;check Drive is FAST DOWN, mDrive is FAST DOWN and STATE is FAST_DOWN
15s A F Drive : speed == FAST
15s A F Drive : direction == DOWN
15s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == FAST
15s A N DRIVE_COMMAND_CAN_ID DriveCommand : getDirection == DOWN
15s A S DriveControl : STATE == FAST_DOWN

;set conditins for T6.14
15.2s I MESSAGE_PERIOD N CAR_LEVEL_POSITION_CAN_ID CarLevelPosition = 10800
15.2s I MESSAGE_PERIOD F DriveSpeed = DOWN 0.15

;check Drive is SLOW DOWN, mDrive is SLOW DOWN and STATE is SLOW_DOWN
15.5s A F Drive : speed == SLOW
15.5s A F Drive : direction == DOWN
15.5s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == SLOW
15.5s A N DRIVE_COMMAND_CAN_ID DriveCommand : getDirection == DOWN
15.5s A S DriveControl : STATE == SLOW_DOWN

;set conditins for T6.10
16s I MESSAGE_PERIOD N AT_FLOOR_[3][FRONT]_CAN_ID AtFloor 3 FRONT = true
16s I MESSAGE_PERIOD N AT_FLOOR_[4][FRONT]_CAN_ID AtFloor 4 FRONT = false
16s I MESSAGE_PERIOD N LEVEL_SENSOR_[UP]_CAN_ID Leveling UP = false
16s I MESSAGE_PERIOD N LEVEL_SENSOR_[DOWN]_CAN_ID Leveling DOWN = false
16s I MESSAGE_PERIOD F DriveSpeed = DOWN 0.05

;check Drive is STOP and STATE is STOP
17s A F Drive : speed == STOP
17s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == STOP
17s A S DriveControl : STATE == STOP

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;set conditins for T6.3
18s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][LEFT]_CAN_ID DoorMotor FRONT LEFT = STOP
18s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][RIGHT]_CAN_ID DoorMotor FRONT RIGHT = STOP
18s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[BACK][LEFT]_CAN_ID DoorMotor BACK LEFT = STOP
18s I MESSAGE_PERIOD N DOOR_MOTOR_COMMAND_[BACK][RIGHT]_CAN_ID DoorMotor BACK RIGHT = STOP

18s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = true
18s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID DoorClosed FRONT RIGHT = true
18s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = true
18s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[BACK][RIGHT]_CAN_ID DoorClosed BACK RIGHT = true

18s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 4 FRONT STOP

18s I MESSAGE_PERIOD N AT_FLOOR_[3][FRONT]_CAN_ID AtFloor 3 FRONT = true

;check Drive is STOP STOP, mDrive is STOP STOP and STATE is STOP
18.011s A F Drive : speed == STOP
18.011s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == STOP
18.011s A S DriveControl : STATE == WAIT

;set conditins for T6.4
18.013s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 3 FRONT STOP

;check Drive is STOP STOP, mDrive is STOP STOP and STATE is STOP
19s A F Drive : speed == STOP
19s A N DRIVE_COMMAND_CAN_ID DriveCommand : getSpeed == STOP
19s A S DriveControl : STATE == STOP


