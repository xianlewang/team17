; 18649 Fall 2013
; group 17
; Xianle Wang(xianlew)
; dispatcher_test1.mf


;this test file demonstrates network and framework message injections
;and network, framework, and controller state assertions.

#INCLUDE disp-define.mf


;intialize 
0s I MESSAGE_PERIOD N DOOR_CLOSED_FL_CAN_ID DoorClosed FRONT LEFT = true
0s I MESSAGE_PERIOD N DOOR_CLOSED_BL_CAN_ID DoorClosed BACK LEFT = true
0s I MESSAGE_PERIOD N DOOR_CLOSED_FR_CAN_ID DoorClosed FRONT RIGHT = true
0s I MESSAGE_PERIOD N DOOR_CLOSED_BR_CAN_ID DoorClosed BACK RIGHT = true
0s I MESSAGE_PERIOD N AT_FLOOR_1F_CAN_ID AtFloor 1 FRONT = true

;check
;#state S11.3 HOLD
0.21s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 1
0.21s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
0.21s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == FRONT
0.21s A S DispatcherControl : STATE == HOLD
0.21s A N DESIRED_DWELL_F_CAN_ID Integer : getValue == 1000

;set condition to T11.3
0.5s I MESSAGE_PERIOD N DOOR_CLOSED_FL_CAN_ID DoorClosed FRONT LEFT = false
0.5s I MESSAGE_PERIOD N DOOR_CLOSED_BL_CAN_ID DoorClosed BACK LEFT = true

;check
;#state S11.2 MOVE
0.56s A S DispatcherControl : STATE == MOVE


;condition T11.2 will be automatically reached
;check 
;#state S11.3 HOLD
0.71s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 2
0.71s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == UP
0.71s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == FRONT
0.71s A N DESIRED_DWELL_F_CAN_ID Integer : getValue == 1000

;set condition to T11.1
0.8s I MESSAGE_PERIOD N AT_FLOOR_1F_CAN_ID AtFloor 1 FRONT = false

;check
;#state S11.2 EMERGENCY_MOVE
1.01s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 1
1.01s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
1.01s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == NONE
1.01s A N DESIRED_DWELL_F_CAN_ID Integer : getValue == 1000
