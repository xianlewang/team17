; 18649 Fall 2013
; group 17
; Shen Yu (sheny)
; sd2a.mf

;can id used
#DEFINE ATFLOOR_4F_CAN_ID                      0xC4C2806
#DEFINE DESIRED_FLOOR_CAN_ID                   0xF0CB600
#DEFINE DOOR_CLOSED_SENSOR_F_L_CAN_ID          0xD145000
#DEFINE DOOR_CLOSED_SENSOR_F_R_CAN_ID          0xD145001
#DEFINE DOOR_OPEN_SENSOR_F_L_CAN_ID            0xEA4A000
#DEFINE DRIVE_SPEED_CAN_ID                     0xF0AB500
#DEFINE CAR_WEIGHT_CAN_ID                      0xDDC7800

;message period
#DEFINE MESSAGE_PERIOD 10ms

;initialize
0s I MESSAGE_PERIOD F CarCall 4 FRONT = false
0s I MESSAGE_PERIOD N ATFLOOR_4F_CAN_ID AtFloor 4 FRONT = false
0s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 4 FRONT UP
0s I MESSAGE_PERIOD N DRIVE_SPEED_CAN_ID DriveCommand = SLOW UP
0s I MESSAGE_PERIOD N DOOR_OPEN_SENSOR_F_L_CAN_ID DoorOpened FRONT LEFT = false
0s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_F_L_CAN_ID DoorClosed FRONT LEFT = true
0s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_F_R_CAN_ID DoorClosed FRONT RIGHT = true
0s I MESSAGE_PERIOD N CAR_WEIGHT_CAN_ID CarWeight = 100

0.2s I MESSAGE_PERIOD N ATFLOOR_4F_CAN_ID AtFloor 4 FRONT = true
0.2s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 4 FRONT STOP
0.2s I MESSAGE_PERIOD N DRIVE_SPEED_CAN_ID DriveCommand = STOP STOP
0.2s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_F_L_CAN_ID DoorClosed FRONT LEFT = false
0.2s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_F_R_CAN_ID DoorClosed FRONT RIGHT = false

0.4s I MESSAGE_PERIOD N DOOR_OPEN_SENSOR_F_L_CAN_ID DoorOpened FRONT LEFT = true

;#arc '2A/1'
1.6s A F DoorMotor FRONT LEFT : command == NUDGE
1.6s A S DoorControl[FRONT][LEFT] : STATE == CLOSING
1.8s I MESSAGE_PERIOD N DOOR_OPEN_SENSOR_F_L_CAN_ID DoorOpened FRONT LEFT = false

;#arc '2A/2'

;#arc '2A/3A'
2s I MESSAGE_PERIOD F CarCall 4 FRONT = true

;#arc '2A/3B'
2.4s A F CarLight 4 FRONT : isLighted == true

;#arc '2B/4A'
2.8s I MESSAGE_PERIOD N CAR_WEIGHT_CAN_ID CarWeight = 20000

;#arc '2B/4B'
3.4s A F DoorMotor FRONT LEFT : command == OPEN
3.4s A S DoorControl[FRONT][LEFT] : STATE == BEFORE_OPEN



















